"use strict";function _isPlaceholder(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function _curry1(t){return function r(e){return 0===arguments.length||_isPlaceholder(e)?r:t.apply(this,arguments)}}function _curry2(t){return function r(e,n){switch(arguments.length){case 0:return r;case 1:return _isPlaceholder(e)?r:_curry1(function(r){return t(e,r)});default:return _isPlaceholder(e)&&_isPlaceholder(n)?r:_isPlaceholder(e)?_curry1(function(r){return t(r,n)}):_isPlaceholder(n)?_curry1(function(r){return t(e,r)}):t(e,n)}}}function _concat(t,r){t=t||[],r=r||[];var e,n=t.length,i=r.length,u=[];for(e=0;e<n;)u[u.length]=t[e],e+=1;for(e=0;e<i;)u[u.length]=r[e],e+=1;return u}function _arity(t,r){switch(t){case 0:return function(){return r.apply(this,arguments)};case 1:return function(t){return r.apply(this,arguments)};case 2:return function(t,e){return r.apply(this,arguments)};case 3:return function(t,e,n){return r.apply(this,arguments)};case 4:return function(t,e,n,i){return r.apply(this,arguments)};case 5:return function(t,e,n,i,u){return r.apply(this,arguments)};case 6:return function(t,e,n,i,u,a){return r.apply(this,arguments)};case 7:return function(t,e,n,i,u,a,c){return r.apply(this,arguments)};case 8:return function(t,e,n,i,u,a,c,o){return r.apply(this,arguments)};case 9:return function(t,e,n,i,u,a,c,o,s){return r.apply(this,arguments)};case 10:return function(t,e,n,i,u,a,c,o,s,l){return r.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function _curryN(t,r,e){return function(){for(var n=arguments,i=[],u=0,a=t,c=0;c<r.length||u<arguments.length;){var o;c<r.length&&(!_isPlaceholder(r[c])||u>=n.length)?o=r[c]:(o=n[u],u+=1),i[c]=o,_isPlaceholder(o)||(a-=1),c+=1}return a<=0?e.apply(this,i):_arity(a,_curryN(t,i,e))}}function _curry3(t){return function r(e,n,i){switch(arguments.length){case 0:return r;case 1:return _isPlaceholder(e)?r:_curry2(function(r,n){return t(e,r,n)});case 2:return _isPlaceholder(e)&&_isPlaceholder(n)?r:_isPlaceholder(e)?_curry2(function(r,e){return t(r,n,e)}):_isPlaceholder(n)?_curry2(function(r,n){return t(e,r,n)}):_curry1(function(r){return t(e,n,r)});default:return _isPlaceholder(e)&&_isPlaceholder(n)&&_isPlaceholder(i)?r:_isPlaceholder(e)&&_isPlaceholder(n)?_curry2(function(r,e){return t(r,e,i)}):_isPlaceholder(e)&&_isPlaceholder(i)?_curry2(function(r,e){return t(r,n,e)}):_isPlaceholder(n)&&_isPlaceholder(i)?_curry2(function(r,n){return t(e,r,n)}):_isPlaceholder(e)?_curry1(function(r){return t(r,n,i)}):_isPlaceholder(n)?_curry1(function(r){return t(e,r,i)}):_isPlaceholder(i)?_curry1(function(r){return t(e,n,r)}):t(e,n,i)}}}function _isTransformer(t){return"function"==typeof t["@@transducer/step"]}function _dispatchable(t,r,e){return function(){if(0===arguments.length)return e();var n=Array.prototype.slice.call(arguments,0),i=n.pop();if(!_isArray(i)){for(var u=0;u<t.length;){if("function"==typeof i[t[u]])return i[t[u]].apply(i,n);u+=1}if(_isTransformer(i)){return r.apply(null,n)(i)}}return e.apply(this,arguments)}}function _map(t,r){for(var e=0,n=r.length,i=Array(n);e<n;)i[e]=t(r[e]),e+=1;return i}function _isString(t){return"[object String]"===Object.prototype.toString.call(t)}function _xwrap(t){return new XWrap(t)}function _arrayReduce(t,r,e){for(var n=0,i=e.length;n<i;){if((r=t["@@transducer/step"](r,e[n]))&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}n+=1}return t["@@transducer/result"](r)}function _iterableReduce(t,r,e){for(var n=e.next();!n.done;){if((r=t["@@transducer/step"](r,n.value))&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}n=e.next()}return t["@@transducer/result"](r)}function _methodReduce(t,r,e,n){return t["@@transducer/result"](e[n](bind(t["@@transducer/step"],t),r))}function _reduce(t,r,e){if("function"==typeof t&&(t=_xwrap(t)),_isArrayLike(e))return _arrayReduce(t,r,e);if("function"==typeof e["fantasy-land/reduce"])return _methodReduce(t,r,e,"fantasy-land/reduce");if(null!=e[symIterator])return _iterableReduce(t,r,e[symIterator]());if("function"==typeof e.next)return _iterableReduce(t,r,e);if("function"==typeof e.reduce)return _methodReduce(t,r,e,"reduce");throw new TypeError("reduce: list must be array or iterable")}function _has(t,r){return Object.prototype.hasOwnProperty.call(r,t)}function _isFunction(t){return"[object Function]"===Object.prototype.toString.call(t)}function _makeFlat(t){return function r(e){for(var n,i,u,a=[],c=0,o=e.length;c<o;){if(_isArrayLike(e[c]))for(u=0,i=(n=t?r(e[c]):e[c]).length;u<i;)a[a.length]=n[u],u+=1;else a[a.length]=e[c];c+=1}return a}}function _forceReduced(t){return{"@@transducer/value":t,"@@transducer/reduced":!0}}function _cloneRegExp(t){return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))}function _clone(t,r,e,n){var i=function(i){for(var u=r.length,a=0;a<u;){if(t===r[a])return e[a];a+=1}r[a+1]=t,e[a+1]=i;for(var c in t)i[c]=n?_clone(t[c],r,e,!0):t[c];return i};switch(type(t)){case"Object":return i({});case"Array":return i([]);case"Date":return new Date(t.valueOf());case"RegExp":return _cloneRegExp(t);default:return t}}function _pipe(t,r){return function(){return r.call(this,t.apply(this,arguments))}}function _checkForMethod(t,r){return function(){var e=arguments.length;if(0===e)return r();var n=arguments[e-1];return _isArray(n)||"function"!=typeof n[t]?r.apply(this,arguments):n[t].apply(n,Array.prototype.slice.call(arguments,0,e-1))}}function pipe(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return _arity(arguments[0].length,reduce(_pipe,arguments[0],tail(arguments)))}function compose(){if(0===arguments.length)throw new Error("compose requires at least one argument");return pipe.apply(this,reverse(arguments))}function _arrayFromIterator(t){for(var r,e=[];!(r=t.next()).done;)e.push(r.value);return e}function _containsWith(t,r,e){for(var n=0,i=e.length;n<i;){if(t(r,e[n]))return!0;n+=1}return!1}function _functionName(t){var r=String(t).match(/^function (\w*)/);return null==r?"":r[1]}function _uniqContentEquals(t,r,e,n){function i(t,r){return _equals(t,r,e.slice(),n.slice())}var u=_arrayFromIterator(t);return!_containsWith(function(t,r){return!_containsWith(i,r,t)},_arrayFromIterator(r),u)}function _equals(t,r,e,n){if(identical(t,r))return!0;var i=type(t);if(i!==type(r))return!1;if(null==t||null==r)return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof r["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](r)&&"function"==typeof r["fantasy-land/equals"]&&r["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof r.equals)return"function"==typeof t.equals&&t.equals(r)&&"function"==typeof r.equals&&r.equals(t);switch(i){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===_functionName(t.constructor))return t===r;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof r||!identical(t.valueOf(),r.valueOf()))return!1;break;case"Date":if(!identical(t.valueOf(),r.valueOf()))return!1;break;case"Error":return t.name===r.name&&t.message===r.message;case"RegExp":if(t.source!==r.source||t.global!==r.global||t.ignoreCase!==r.ignoreCase||t.multiline!==r.multiline||t.sticky!==r.sticky||t.unicode!==r.unicode)return!1}for(var u=e.length-1;u>=0;){if(e[u]===t)return n[u]===r;u-=1}switch(i){case"Map":return t.size===r.size&&_uniqContentEquals(t.entries(),r.entries(),e.concat([t]),n.concat([r]));case"Set":return t.size===r.size&&_uniqContentEquals(t.values(),r.values(),e.concat([t]),n.concat([r]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var a=keys(t);if(a.length!==keys(r).length)return!1;var c=e.concat([t]),o=n.concat([r]);for(u=a.length-1;u>=0;){var s=a[u];if(!_has(s,r)||!_equals(r[s],t[s],c,o))return!1;u-=1}return!0}function _indexOf(t,r,e){var n,i;if("function"==typeof t.indexOf)switch(typeof r){case"number":if(0===r){for(n=1/r;e<t.length;){if(0===(i=t[e])&&1/i===n)return e;e+=1}return-1}if(r!=r){for(;e<t.length;){if("number"==typeof(i=t[e])&&i!=i)return e;e+=1}return-1}return t.indexOf(r,e);case"string":case"boolean":case"function":case"undefined":return t.indexOf(r,e);case"object":if(null===r)return t.indexOf(r,e)}for(;e<t.length;){if(equals(t[e],r))return e;e+=1}return-1}function _contains(t,r){return _indexOf(r,t,0)>=0}function _quote(t){return'"'+t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}function _complement(t){return function(){return!t.apply(this,arguments)}}function _filter(t,r){for(var e=0,n=r.length,i=[];e<n;)t(r[e])&&(i[i.length]=r[e]),e+=1;return i}function _isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}function _toString(t,r){var e=function(e){var n=r.concat([t]);return _contains(e,n)?"<Circular>":_toString(e,n)},n=function(t,r){return _map(function(r){return _quote(r)+": "+e(t[r])},r.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+_map(e,t).join(", ")+"))";case"[object Array]":return"["+_map(e,t).concat(n(t,reject(function(t){return/^\d+$/.test(t)},keys(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+e(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+(isNaN(t.valueOf())?e(NaN):_quote(_toISOString(t)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+e(t.valueOf())+")":1/t==-1/0?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+e(t.valueOf())+")":_quote(t);case"[object Undefined]":return"undefined";default:if("function"==typeof t.toString){var i=t.toString();if("[object Object]"!==i)return i}return"{"+n(t,keys(t)).join(", ")+"}"}}function _identity(t){return t}function hasOrAdd(t,r,e){var n,i=typeof t;switch(i){case"string":case"number":return 0===t&&1/t==-1/0?!!e._items["-0"]||(r&&(e._items["-0"]=!0),!1):null!==e._nativeSet?r?(n=e._nativeSet.size,e._nativeSet.add(t),e._nativeSet.size===n):e._nativeSet.has(t):i in e._items?t in e._items[i]||(r&&(e._items[i][t]=!0),!1):(r&&(e._items[i]={},e._items[i][t]=!0),!1);case"boolean":if(i in e._items){var u=t?1:0;return!!e._items[i][u]||(r&&(e._items[i][u]=!0),!1)}return r&&(e._items[i]=t?[!1,!0]:[!0,!1]),!1;case"function":return null!==e._nativeSet?r?(n=e._nativeSet.size,e._nativeSet.add(t),e._nativeSet.size===n):e._nativeSet.has(t):i in e._items?!!_contains(t,e._items[i])||(r&&e._items[i].push(t),!1):(r&&(e._items[i]=[t]),!1);case"undefined":return!!e._items[i]||(r&&(e._items[i]=!0),!1);case"object":if(null===t)return!!e._items.null||(r&&(e._items.null=!0),!1);default:return(i=Object.prototype.toString.call(t))in e._items?!!_contains(t,e._items[i])||(r&&e._items[i].push(t),!1):(r&&(e._items[i]=[t]),!1)}}function _isNumber(t){return"[object Number]"===Object.prototype.toString.call(t)}function _createPartialApplicator(t){return _curry2(function(r,e){return _arity(Math.max(0,r.length-e.length),function(){return r.apply(this,t(e,arguments))})})}function doArrayWalk(t,r,e,n){return!!Array.isArray(r)&&!!(e||n&&n.includes(t))}function getPath(t,r){return void 0===t&&(t="array"),{_path:r||("array"===t?[]:""),set:function(r,e){var n;switch(t){case"array":n=this._path.concat([e]);break;case"nestedProperty":n=0===this._path.length?e:Array.isArray(r)?this._path+"["+e+"]":this._path+"."+e;break;default:throw new Error("unrecognized pathType "+t)}return getPath(t,n)},get:function(r,e){return"array"===t?this._path:this.set(r,e)._path}}}function makeAttrSetterPath(t){var r="",e=0;"_fullData"===t[e]&&(e+=2),"_fullInput"===t[e]&&e++,"_fullLayout"===t[e]&&e++;for(var n=e;n<t.length;n++)"number"==typeof t[n]||Array.isArray(t[n])?r+="["+(Array.isArray(t[n])?t[n][0]:t[n])+"]":r+=(n>e?".":"")+t[n];return r}function _walkObject(t,r,e,n){var i=n.walkArrays,u=n.walkArraysMatchingKeys;Object.keys(t).forEach(function(a){if(!r(a,t,e.get(t,a))){var c=t[a];(isPlainObject(c)||doArrayWalk(a,c,i,u))&&_walkObject(c,r,e.set(t,a),n)}})}function walkObject(t,r,e){if(void 0===e&&(e={}),!isPlainObject(t)&&!Array.isArray(t))throw new Error("The input must be an object.");_walkObject(t,r,getPath(e.pathType),e)}function getEventPoints(t,r,e){var n=r.constrained&&"pie"===t._fullData[0].type?null:e;return"pie"===t._fullData[0].type?n?n.points:[]:("histogram"===t._fullData[0].type&&(n={points:[]},e&&!Array.isArray(e)&&e.points.forEach(function(r){(r.pointNumbers||t.calcdata[0][r.pointNumber].pts).forEach(function(t){n.points.push({pointNumber:t,curveNumber:r.curveNumber,data:r.data,fullData:r.fullData})})})),n?n.points.filter(function(r){return r.curveNumber<t._cfData.originalData.length&&r.data.uid===t.data[r.curveNumber].uid}):[])}function toggleContextHover(t,r,e,n){var i=n?"none":r._cfData.originalFullData[e].hoverinfo;i&&r._fullData[e].hoverinfo!==i&&-1===["scattermapbox","scattergeo","scatter3d"].indexOf(r._fullData[0].type)&&t.restyle(r,"hoverinfo",i,[e])}function dimTracePostStyle(t,r,e,n,i){var u=t.d3.select(r);switch(n.type){case"choropleth":toggleContextHover(t,r,i,e);var a=r._cfData.originalOpacity[i];return u.selectAll(".trace path").style("opacity",1),u.selectAll(".trace").filter(function(t,r){return r===i}).style("opacity",e?0:a),u.selectAll(".colorbar .cbaxis").style("opacity",0),void window.setTimeout(function(){u.selectAll(".colorbar .cbaxis").style("opacity",function(t,r){return r===i&&e?0:null})});case"scatter":case"box":toggleContextHover(t,r,i,e);var c=r._cfData.originalOpacity[i];return void u.selectAll(".trace").filter(function(t,r){return r===i}).style("opacity",e?DESELECTDIM:c);case"bar":if(toggleContextHover(t,r,i,e),"stack"===r.layout.barmode)t.restyle(r,"visible",!e,range(0,r._cfData.originalData.length));else{var o=r._cfData.originalOpacity[i];u.selectAll(".trace").filter(function(t,r){return r===i}).style("opacity",e?DESELECTDIM:o)}return;case"histogram":var s=r._cfData.originalOpacity[i];return void u.selectAll(".trace").filter(function(t,r){return r===i}).style("opacity",e?0:s);case"table":return void u.select(".table").style("opacity",e?0:null);case"pie":return u.select(".trace").style("opacity",e?0:null),void u.selectAll(".hovertext").remove();case"scattermapbox":return void t.restyle(r,"marker.opacity",e?DESELECTDIM_MAPBOX:1,[i]);case"scatter3d":return void t.restyle(r,"marker.opacity",e?DESELECTDIM:r._cfData.originalFullData[i].marker.opacity,[i]);default:return void t.d3.select(r).select(".trace").style("opacity",e?DESELECTDIM:null)}}Object.defineProperty(exports,"__esModule",{value:!0});var always=_curry1(function(t){return function(){return t}}),F=always(!1),T=always(!0),add=_curry2(function(t,r){return Number(t)+Number(r)}),curryN=_curry2(function(t,r){return 1===t?_curry1(r):_arity(t,_curryN(t,[],r))}),_isArray=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)},_xfBase={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}},max=_curry2(function(t,r){return r>t?r:t}),_isArrayLike=_curry1(function(t){return!!_isArray(t)||!!t&&("object"==typeof t&&(!_isString(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),XWrap=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,r){return this.f(t,r)},t}(),bind=_curry2(function(t,r){return _arity(t.length,function(){return t.apply(r,arguments)})}),symIterator="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",XMap=function(){function t(t,r){this.xf=r,this.f=t}return t.prototype["@@transducer/init"]=_xfBase.init,t.prototype["@@transducer/result"]=_xfBase.result,t.prototype["@@transducer/step"]=function(t,r){return this.xf["@@transducer/step"](t,this.f(r))},t}(),_xmap=_curry2(function(t,r){return new XMap(t,r)}),toString=Object.prototype.toString,_isArguments=function(){return"[object Arguments]"===toString.call(arguments)?function(t){return"[object Arguments]"===toString.call(t)}:function(t){return _has("callee",t)}},hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],hasArgsEnumBug=function(){return arguments.propertyIsEnumerable("length")}(),contains=function(t,r){for(var e=0;e<t.length;){if(t[e]===r)return!0;e+=1}return!1},_keys="function"!=typeof Object.keys||hasArgsEnumBug?function(t){if(Object(t)!==t)return[];var r,e,n=[],i=hasArgsEnumBug&&_isArguments(t);for(r in t)!_has(r,t)||i&&"length"===r||(n[n.length]=r);if(hasEnumBug)for(e=nonEnumerableProps.length-1;e>=0;)_has(r=nonEnumerableProps[e],t)&&!contains(n,r)&&(n[n.length]=r),e-=1;return n}:function(t){return Object(t)!==t?[]:Object.keys(t)},keys=_curry1(_keys),map=_curry2(_dispatchable(["fantasy-land/map","map"],_xmap,function(t,r){switch(Object.prototype.toString.call(r)){case"[object Function]":return curryN(r.length,function(){return t.call(this,r.apply(this,arguments))});case"[object Object]":return _reduce(function(e,n){return e[n]=t(r[n]),e},{},keys(r));default:return _map(t,r)}})),path=_curry2(function(t,r){for(var e=r,n=0;n<t.length;){if(null==e)return;e=e[t[n]],n+=1}return e}),prop=_curry2(function(t,r){return path([t],r)}),pluck=_curry2(function(t,r){return map(prop(t),r)}),reduce=_curry3(_reduce),ap=_curry2(function(t,r){return"function"==typeof r["fantasy-land/ap"]?r["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(r):"function"==typeof t?function(e){return t(e)(r(e))}:_reduce(function(t,e){return _concat(t,map(e,r))},[],t)}),values=_curry1(function(t){for(var r=keys(t),e=r.length,n=[],i=0;i<e;)n[i]=t[r[i]],i+=1;return n}),liftN=_curry2(function(t,r){var e=curryN(t,r);return curryN(t,function(){return _reduce(ap,map(e,arguments[0]),Array.prototype.slice.call(arguments,1))})}),lift=_curry1(function(t){return liftN(t.length,t)}),curry=_curry1(function(t){return curryN(t.length,t)}),call=curry(function(t){return t.apply(this,Array.prototype.slice.call(arguments,1))}),preservingReduced=function(t){return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(r){return t["@@transducer/result"](r)},"@@transducer/step":function(r,e){var n=t["@@transducer/step"](r,e);return n["@@transducer/reduced"]?_forceReduced(n):n}}},_flatCat=function(t){var r=preservingReduced(t);return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(t){return r["@@transducer/result"](t)},"@@transducer/step":function(t,e){return _isArrayLike(e)?_reduce(r,t,e):_reduce(r,t,[e])}}},_xchain=_curry2(function(t,r){return map(t,_flatCat(r))}),chain=_curry2(_dispatchable(["fantasy-land/chain","chain"],_xchain,function(t,r){return"function"==typeof r?function(e){return t(r(e))(e)}:_makeFlat(!1)(map(t,r))})),type=_curry1(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}),clone=_curry1(function(t){return null!=t&&"function"==typeof t.clone?t.clone():_clone(t,[],[],!0)}),not=_curry1(function(t){return!t}),complement=lift(not),slice=_curry3(_checkForMethod("slice",function(t,r,e){return Array.prototype.slice.call(e,t,r)})),tail=_curry1(_checkForMethod("tail",slice(1,1/0))),reverse=_curry1(function(t){return _isString(t)?t.split("").reverse().join(""):Array.prototype.slice.call(t,0).reverse()}),identical=_curry2(function(t,r){return t===r?0!==t||1/t==1/r:t!=t&&r!=r}),equals=_curry2(function(t,r){return _equals(t,r,[],[])}),pad=function(t){return(t<10?"0":"")+t},_toISOString="function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+pad(t.getUTCMonth()+1)+"-"+pad(t.getUTCDate())+"T"+pad(t.getUTCHours())+":"+pad(t.getUTCMinutes())+":"+pad(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"},XFilter=function(){function t(t,r){this.xf=r,this.f=t}return t.prototype["@@transducer/init"]=_xfBase.init,t.prototype["@@transducer/result"]=_xfBase.result,t.prototype["@@transducer/step"]=function(t,r){return this.f(r)?this.xf["@@transducer/step"](t,r):t},t}(),_xfilter=_curry2(function(t,r){return new XFilter(t,r)}),filter=_curry2(_dispatchable(["filter"],_xfilter,function(t,r){return _isObject(r)?_reduce(function(e,n){return t(r[n])&&(e[n]=r[n]),e},{},keys(r)):_filter(t,r)})),reject=_curry2(function(t,r){return filter(_complement(t),r)}),toString$1=_curry1(function(t){return _toString(t,[])}),converge=_curry2(function(t,r){return curryN(reduce(max,0,pluck("length",r)),function(){var e=arguments,n=this;return t.apply(n,_map(function(t){return t.apply(n,e)},r))})}),XReduceBy=function(){function t(t,r,e,n){this.valueFn=t,this.valueAcc=r,this.keyFn=e,this.xf=n,this.inputs={}}return t.prototype["@@transducer/init"]=_xfBase.init,t.prototype["@@transducer/result"]=function(t){var r;for(r in this.inputs)if(_has(r,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[r]))["@@transducer/reduced"]){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,r){var e=this.keyFn(r);return this.inputs[e]=this.inputs[e]||[e,this.valueAcc],this.inputs[e][1]=this.valueFn(this.inputs[e][1],r),t},t}(),_xreduceBy=_curryN(4,[],function(t,r,e,n){return new XReduceBy(t,r,e,n)}),reduceBy=_curryN(4,[],_dispatchable([],_xreduceBy,function(t,r,e,n){return _reduce(function(n,i){var u=e(i);return n[u]=t(_has(u,n)?n[u]:r,i),n},{},n)})),countBy=reduceBy(function(t,r){return t+1},0),dec=add(-1),XDropRepeatsWith=function(){function t(t,r){this.xf=r,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}return t.prototype["@@transducer/init"]=_xfBase.init,t.prototype["@@transducer/result"]=_xfBase.result,t.prototype["@@transducer/step"]=function(t,r){var e=!1;return this.seenFirstValue?this.pred(this.lastValue,r)&&(e=!0):this.seenFirstValue=!0,this.lastValue=r,e?t:this.xf["@@transducer/step"](t,r)},t}(),_xdropRepeatsWith=_curry2(function(t,r){return new XDropRepeatsWith(t,r)}),nth=_curry2(function(t,r){var e=t<0?r.length+t:t;return _isString(r)?r.charAt(e):r[e]}),last=nth(-1),dropRepeatsWith=_curry2(_dispatchable([],_xdropRepeatsWith,function(t,r){var e=[],n=1,i=r.length;if(0!==i)for(e[0]=r[0];n<i;)t(last(e),r[n])||(e[e.length]=r[n]),n+=1;return e})),dropRepeats=_curry1(_dispatchable([],_xdropRepeatsWith(equals),dropRepeatsWith(equals))),flip=_curry1(function(t){return curryN(t.length,function(r,e){var n=Array.prototype.slice.call(arguments,0);return n[0]=e,n[1]=r,t.apply(this,n)})}),groupBy=_curry2(_checkForMethod("groupBy",reduceBy(function(t,r){return null==t&&(t=[]),t.push(r),t},null))),head=nth(0),identity=_curry1(_identity),inc=add(1),indexBy=reduceBy(function(t,r){return r},null),init=slice(0,-1),_Set=function(){function t(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return t.prototype.add=function(t){return!hasOrAdd(t,!0,this)},t.prototype.has=function(t){return hasOrAdd(t,!1,this)},t}(),uniqBy=_curry2(function(t,r){for(var e,n,i=new _Set,u=[],a=0;a<r.length;)e=t(n=r[a]),i.add(e)&&u.push(n),a+=1;return u}),uniq=uniqBy(identity),invoker=_curry2(function(t,r){return curryN(t+1,function(){var e=arguments[t];if(null!=e&&_isFunction(e[r]))return e[r].apply(e,Array.prototype.slice.call(arguments,0,t));throw new TypeError(toString$1(e)+' does not have a method named "'+r+'"')})}),join=invoker(1,"join"),juxt=_curry1(function(t){return converge(function(){return Array.prototype.slice.call(arguments,0)},t)}),sum=reduce(add,0),memoizeWith=_curry2(function(t,r){var e={};return _arity(r.length,function(){var n=t.apply(this,arguments);return _has(n,e)||(e[n]=r.apply(this,arguments)),e[n]})}),memoize=memoizeWith(function(){return toString$1(arguments)}),multiply=_curry2(function(t,r){return t*r}),partialRight=_createPartialApplicator(flip(_concat)),partition=juxt([filter,reject]),pickAll=_curry2(function(t,r){for(var e={},n=0,i=t.length;n<i;){var u=t[n];e[u]=r[u],n+=1}return e}),product=reduce(multiply,1),useWith=_curry2(function(t,r){return curryN(r.length,function(){for(var e=arguments,n=[],i=0;i<r.length;)n.push(r[i].call(this,e[i])),i+=1;return t.apply(this,n.concat(Array.prototype.slice.call(arguments,r.length)))})}),project=useWith(_map,[pickAll,identity]),range=_curry2(function(t,r){if(!_isNumber(t)||!_isNumber(r))throw new TypeError("Both arguments to range must be numbers");for(var e=[],n=t;n<r;)e.push(n),n+=1;return e}),split=invoker(1,"split"),toLower=invoker(0,"toLowerCase"),toPairs=_curry1(function(t){var r=[];for(var e in t)_has(e,t)&&(r[r.length]=[e,t[e]]);return r}),toUpper=invoker(0,"toUpperCase"),transduce=curryN(4,function(t,r,e,n){return _reduce(t("function"==typeof r?_xwrap(r):r),e,n)}),ws="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",zeroWidth="​",hasProtoTrim="function"==typeof String.prototype.trim,_trim=hasProtoTrim&&!ws.trim()&&zeroWidth.trim()?function(t){return t.trim()}:function(t){var r=new RegExp("^["+ws+"]["+ws+"]*"),e=new RegExp("["+ws+"]["+ws+"]*$");return t.replace(r,"").replace(e,"")},union=_curry2(compose(uniq,_concat)),unnest=chain(_identity),isPlainObject=require("is-plain-object");module.exports=require("./crossfilter").crossfilter;var crossfilter=Object.freeze({}),cf=crossfilter,CROSSFILTER_WHITELISTED_PLOTS=["bar","box","choropleth","histogram","pie","scatter","scatter3d","scattergeo","scattermapbox","table"],DESELECTDIM=.1,DESELECTDIM_MAPBOX=.01,srcFieldSuffix="src",keepColumnId=/[^:]+(?=[^:]*$)/,gridSourceAttribute=function(t){return"src"===t.slice(-srcFieldSuffix.length)},getBaseAttributeName=function(t){return t.slice(0,-srcFieldSuffix.length)},getPlotArray=function(t){return[].slice.call(t.querySelectorAll(".js-plotly-plot"))},collectFieldSourcesInTrace=function(t,r,e){return walkObject(r,function(n,i,u){var a=t._crossfilter;if(!("table"===r.type&&"header"===u[0])&&gridSourceAttribute(n)){var c=i[n].match(keepColumnId)[0],o=n,s=getBaseAttributeName(o),l=[];if("table"===r.type&&"cells"===u[0]){c.replace(/\*/g,"").split(",").forEach(function(r,n){var a=u.concat([s,n]);l.push({gd:t,srcFieldName:o,traceIndex:e,data:i[s][n],pathArray:a,fieldPath:makeAttrSetterPath(a),constrained:!1,gridColumnName:r})})}else l.push({gd:t,srcFieldName:o,traceIndex:e,data:i[s],pathArray:u.concat([s]),fieldPath:makeAttrSetterPath(u.concat([s])),constrained:!1,gridColumnName:c});l.forEach(function(t){a.fieldSources[t.gridColumnName]=(a.fieldSources[t.gridColumnName]||[]).concat(t)})}},{walkArraysMatchingKeys:["transforms"]})},eventPointsToDataPoints=function(t,r){for(var e={},n=0;n<r.length;n++){var i=r[n],u=i.fullData&&i.fullData.transforms,a=u?u.filter(function(t){return t._indexToPoints}):[];if(a.length){a[a.length-1]._indexToPoints[i.pointNumber].forEach(function(t){e[t]={pointNumber:t}})}else if("pie"===t._fullData[0].type)for(var c=0;c<t.data[0].labels.length;c++)t.data[0].labels[c]===i.label&&(e[c]={pointNumber:c});else e[i.pointNumber]=i}return e},isDashboardCompliantForCrossfilter=function(t){var r=t.every(function(t){return-1!==CROSSFILTER_WHITELISTED_PLOTS.indexOf(t.type)}),e={};t.forEach(function(t){return Object.keys(t).filter(gridSourceAttribute).forEach(function(r){var n=t[getBaseAttributeName(r)].length;e[n]=!0})});var n=Object.keys(e).length<2,i=!1;return t.some(function(t){return walkObject(t,function(t){gridSourceAttribute(t)&&(i=!0)},{walkArraysMatchingKeys:["transforms"]})}),r&&i&&n},setDeepProp=function(t,r,e){for(var n=0,i=t;n<r.length;n++){var u=r[n],a=void 0!==i[u];n===r.length-1?i[u]=e:a||(i[u]={}),i=i[u]}},gridBackedAttribute=function(t){return"src"===t.slice(-srcFieldSuffix.length)},eraseGridPropsFromTrace=function(t){return walkObject(t,function(t,r,e){gridBackedAttribute(t)&&"header"!==e[0]&&(r[getBaseAttributeName(t)]=[])},{walkArraysMatchingKeys:["transforms"]})},cfEnabled=function(t,r){return t&&isDashboardCompliantForCrossfilter(r.data)},cfLayoutOverrides={dragmode:"select",showlegend:!1},getCrossfilter=function(t){return t.length?t[0]._crossfilter:{fieldSources:{},cf:null,grid:{}}},persistCrossfilter=function(t,r){t._crossfilter=r},restylePlots=function(t,r,e){var n=r.plotDimensions.concat(r.formDimensions).some(function(t){return t.constrained}),i=n?r.recordDimension.top(1/0).sort(function(t,r){return t.index-r.index}):[];e.filter(function(t){return t.includedInCrossfilter}).forEach(function(e){var u=e._cfData.originalData.map(clone);u.forEach(eraseGridPropsFromTrace);[].concat.apply([],values(r.fieldSources)).filter(function(t){return t.gd===e}).forEach(function(r){var n=i.map(function(t){return t[r.gridColumnName]});u.forEach(function(i,u){if(u===r.traceIndex){setDeepProp(i,r.pathArray,n);var a=e._fullData[u].marker||{},c=t.Lib.isArray(a.color),o=!c||c&&!t.Lib.isNumeric(a.color[0]);"pie"!==i.type&&e._fullData[u].marker&&o&&(i.marker=i.marker||{},i.marker.color=e._fullData[u].marker.color)}})}),t.deleteTraces(e,range(e._cfData.originalData.length,e.data.length)),n&&e._fullData.length===e._cfData.originalData.length&&t.addTraces(e,u),u.forEach(function(r,i){return dimTracePostStyle(t,e,n,r,i)})})},resetAllFilters=function(t){return t.plotDimensions.concat(t.formDimensions).forEach(function(t){t.constrained=!1,t.cfDimension&&t.cfDimension.filter(null)})},resetCrossfilter=function(t){var r=getPlotArray(document),e=r[0]._crossfilter;resetAllFilters(e),restylePlots(t,e,[].concat(r).filter(function(t){return t.includedInCrossfilter}))},specFilter=function(t,r){var e=getPlotArray(document),n=r.gridColumn,i=r.isNaN?r.value:Number(r.value),u=r.operator,a=e[0]._crossfilter,c=a.formDimensions[0];c.constrained=!0,c.cfDimension&&(c.cfDimension.filter(null),c.cfDimension.dispose(),c.cfDimension=null,c.constrained=!1),c.cfDimension=a.cf.dimension(function(t){return t[n]});var o={">":function(t){return t>i},"<":function(t){return t<i},"==":function(t){return t===i}}[u];c.cfDimension.filterFunction(o),c.constrained=!0,restylePlots(t,a,[].concat(e).filter(function(t){return t.includedInCrossfilter}))},selectionHandler=function(t,r,e){var n=r._crossfilter,i=n.plotDimensions.find(function(t){return t.gd===r}),u=getEventPoints(r,i,e);resetAllFilters(n);var a=eventPointsToDataPoints(r,u);i.constrained=u.length>0,i.constrained||r.querySelectorAll(".select-outline").forEach(function(t){return t.parentNode.removeChild(t)}),i.cfDimension.filterFunction(i.constrained?function(t){return a[t]}:function(){return!0}),t.restyle(r,"selectedpoints",null),restylePlots(t,n,getPlotArray(document).filter(function(t){return t.includedInCrossfilter}))},cfPlotSetup=function(t,r,e,n,i){var u=getCrossfilter(r);persistCrossfilter(n,u),i.data.forEach(function(t,r){return collectFieldSourcesInTrace(n,t,r)}),Object.keys(u.fieldSources).forEach(function(t){var r=u.fieldSources[t];u.grid[t]=r[0].data}),u.cf=cf(),e.then(function(r){"pie"===r._fullData[0].type?r.on("plotly_click",selectionHandler.bind(0,t,r)):r.on("plotly_selected",selectionHandler.bind(0,t,r)),r.includedInCrossfilter=!0,u.plotDimensions=getPlotArray(document).filter(function(t){return t.includedInCrossfilter}).map(function(t){return{gd:t,constrained:!1,cfDimension:u.cf.dimension(function(t){return t.index})}}),u.formDimensions=[{gd:void 0,constrained:!1,cfDimension:null}],n._cfData={originalData:n.data.map(clone),originalFullData:n._fullData.map(clone),originalOpacity:map(function(t){return t.style.opacity})(n.querySelectorAll(".trace"))}}),u.recordDimension=u.cf.dimension(function(t){return t});var a=toPairs(u.grid);if(a.length){var c=a[0][1].map(function(t,r){for(var e={},n=0;n<a.length;n++)e.index=r,e[a[n][0]]=a[n][1][r];return e});u.cf.add(c)}};exports.cfEnabled=cfEnabled,exports.cfLayoutOverrides=cfLayoutOverrides,exports.resetCrossfilter=resetCrossfilter,exports.specFilter=specFilter,exports.cfPlotSetup=cfPlotSetup;
